# 补充性规格说明
## 修订历史

|版本|日期|描述|作者
| --------   | :-----  | :----  | -
|初始草案|2018年6月4日|补充前半部分内容细则|高晨

## 简介
本文档记录了EOEO所有未在用例中描述的需求。

## 功能性
1. 菜单储存和管理

在持久性存储中记录各商家的菜单。

2. 安全性

不同角色对商家数据进行操作需要不同的权限，高级权限需要经过用户认证。

## 可用性
人性因素
食客可能因为不清楚扫码规则或者自身变动而进行第二次错误的扫码操作，因此对上一次操作的状态存储是有必要的。

厨师的视线通常专注于菜品，因此提示应通过声音的传递而不仅仅是通过图像传递。

## 可靠性
1. 可恢复性

如可用性中所说的，需要在食客的本地设备中存储操作状态，从而减小对错误操作的恢复代价。

2. 安全性

因为用户支付过程中可能存在着账号的风险，所以在支付接口对接的部分，还需要尽量考虑操作的安全性设计。

## 可支持性
1. 可适应性

不同食客与商家所采用的使用设备不同，所以在开发的过程中需要对此使用不同的UI设计和支持。

## 实现约束
EOEO采用微信小程序+web框架（vue + python + flask）进行开发，能够更加方便快捷的实现开发过程，同时保证稳定性。

## 购买构件
- 具有扫描二维码功能的手机。

## 免费开源构件
在实现功能的过程中，构件的使用必不可少，目前已确认使用的有：
* weui-wxss开发插件
* 二维码制作js插件
* flask开发框架

## 接口
1.重要硬件和接口

- 触摸屏 （操作系统将此视为普通监视器，且触摸动作也视为鼠标事件）。
- 票据打印机

2.软件接口
由于存在众多外部协作系统（税金计算器、财务、... ...)，我们需要采用不同的接口，接入不同的系统。

## 应用的领域（业务）规则
（一般性规则参见单独的业务规则文档）

| ID        | 规则   |  可变性  | 来源
| --------   | :-----  | :----  | -
| 规则1     | 顾客折扣规则。示例：员工：15%折扣额； 优先顾客：10%折扣额； 高级：15%折扣额。 |   高，每个商家有不同规则    | 餐饮业政策
| 规则2        |   销售（交易级）折扣规则适用于税前总额。示例：如果超过100元，折扣额为10%；每周一折扣额为5%；每天上午10点到下午3点的折扣额为10%；每天上午9点到上午10点饮料的折扣额为20%。   |   高，每个商家有不同的规则，每天或者每小时都可能改变   | 餐饮业政策
| 规则3        |    商品折扣规则。示例：小龙虾本周折扣额为10%；猪扒包买二送一。   |  高，每个商家有不同规则，每天或者每小时都可能改变  | 餐饮业政策

## 法律问题
我们建议使用一些开源构件，但是要解决其许可限制的问题，以便使包含开源软件的产品能够转售。法律规定，在销售交易中必须遵从所有的税务规则。同时要注意的是，这些规则可以频繁变更。

## 所关注邻域内的信息
1. 定价
除了在“应用的领域规则”小节中描述的定价规则之外，还需要注意，商品有原始价格和可选的常设低标价之分。商品标示的价格（折扣前）是常设低标价。由于财务和税务的原因，即使有常设低标价，也需要维护原始价格。

2. 信用卡和借记卡支付处理
当支付授权处理批准了信用卡或借记卡支付后，将由支付授权服务而不是买方来负责对卖方的支付。因此，对于每笔支付，卖方都需要将授权服务的未支付金额记录于其应收账户下。通常，授权服务在每晚执行电子转账操作，将卖方当天的应收总额转入其账户下，同时对每笔交易扣除（少量的）服务费。

3. 销售税
销售税的计算可能会十分复杂，并且会根据各级政府的立法而定期变更。因此，对税金计算采用第三方软件（存在许多可选的第三方软件）是明智之举。税金可能分别归属于城市，地区，省和国家。某些商品可能是无条件免税的，或者是根据买房或目标受害者（例如，成人或儿童）进行免税。

4. 二维码生成装置
二维码生成装置其实就是二维码生成软件，二维码生成器的工作原理是将所需的信息输入二维码生成器中，生成相应的二维码，然后进行保存应用。
二维码生成器的制作需要一个二维码生成算法，或者一个二维码插件，然后用JAVA ，C#，VB等编程语言编写一个调用软件。
